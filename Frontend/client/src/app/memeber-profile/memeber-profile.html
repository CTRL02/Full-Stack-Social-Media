<div class="profile-container">
  <div class="profile-header">
    <div class="profile-avatar">
      <img [src]="user?.avatar || 'assets/default.jpg'" alt="Profile picture">
    </div>
    <h1>{{ user?.username || 'Username' }}</h1>
    <h2>{{ user?.title || 'Member' }}</h2>
  </div>

  <div class="profile-content">
    <div class="profile-section about-section">
      <h3>{{ 'PROFILE.ABOUT' | translate }}</h3>
      <p>{{ user?.bio || 'No bio available' }}</p>
    </div>

    <div class="profile-section stats-section">

      <div class="stat-item">
        <span class="stat-value">{{ user?.noOfPosts || 'no posts' }}</span>
        <span class="stat-label">{{ 'PROFILE.POSTS' | translate }}</span>
      </div>

      <!-- Followers dropdown -->
      <div class="stat-item dropdown">
        <span class="stat-value">{{ user?.noOfFollowers || 0 }}</span>
        <span class="stat-label">{{ 'PROFILE.FOLLOWERS' | translate }}</span>
        <ul class="dropdown-menu">
          <li *ngFor="let follower of user?.followers">
            <img [src]="follower.avatar" alt="avatar" class="dropdown-avatar">
            <span>{{ follower.username }}</span>
          </li>
        </ul>
      </div>

      <!-- Following dropdown -->
      <div class="stat-item dropdown">
        <span class="stat-value">{{ user?.noOfFollowing || 0 }}</span>
        <span class="stat-label">{{ 'PROFILE.FOLLOWING' | translate }}</span>
        <ul class="dropdown-menu">
          <li *ngFor="let followee of user?.following">
            <img [src]="followee.avatar" alt="avatar" class="dropdown-avatar">
            <span>{{ followee.username }}</span>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="profile-footer">
    <div class="social-links">
      <a *ngFor="let link of user?.socialLinks" [href]="link" target="_blank" class="social-link">
        <i [ngClass]="getSocialIcon(link)"></i>
      </a>
    </div>
  </div>
  <!--will do later-->
  <!--<button class="btn btn-primary">Edit Profile</button>-->
  <!-- User Posts Section -->
  <div class="profile-section posts-section" *ngIf="user?.posts?.length">
    <h3>{{ user?.username }} {{ 'PROFILE.POSTS_TITLE' | translate }}</h3>

    <div class="posts-container">
      <div class="post" *ngFor="let post of user?.posts">
        <div class="post-header">
          <img [src]="user?.avatar || 'assets/default.jpg'" class="post-avatar" alt="avatar">
          <div>
            <div class="post-username">{{ user?.username }}</div>
            <div class="post-date">{{ post?.createdAt | date:'medium' }}</div>
          </div>
        </div>

        <div class="post-content">
          <p>{{ post?.content }}</p>
        </div>

        <!-- Action Area -->
        <div class="row g-1 mt-3">
          <!-- Impressions -->
          <div class="col-6 text-center position-relative">
            <a href="javascript:void(0)"
               class="text-primary text-decoration-underline small mb-1 d-inline-block position-relative z-1">
              {{ post?.impressions?.length || 0 }} Impressions
            </a>

            <div class="reaction-container d-inline-block position-relative">
              <button class="btn btn-light btn-sm rounded-pill d-flex align-items-center gap-2">
                [ngClass]="{ 'reaction-selected': selectedReactions[post.id] }">
                <img *ngIf="selectedReactions[post.id]"
                     [src]="reactionIcons[selectedReactions[post.id]]"
                     class="reaction-icon"
                     style="width: 18px; height: 18px;" />
                {{ selectedReactions[post.id] || 'Like' }}
              </button>

              <div class="reactions-menu position-absolute bg-body shadow p-2 rounded-pill">
                <img src="assets/reactions/like.png" alt="Like" class="reaction-icon"
                     (click)="leaveImpression('Like', post.id)" />
                <img src="assets/reactions/love.png" alt="Love" class="reaction-icon"
                     (click)="leaveImpression('Love', post.id)" />
                <img src="assets/reactions/care.png" alt="Care" class="reaction-icon"
                     (click)="leaveImpression('Care', post.id)" />
                <img src="assets/reactions/sad.png" alt="Sad" class="reaction-icon"
                     (click)="leaveImpression('Sad', post.id)" />
                <img src="assets/reactions/angry.png" alt="Angry" class="reaction-icon"
                     (click)="leaveImpression('Angry', post.id)" />
              </div>
            </div>
          </div>

          <!-- Comments -->
          <div class="col-6 text-center">
            <a href="javascript:void(0)"
               (click)="openComments(post.id)"
               class="text-primary text-decoration-underline small mb-1 d-inline-block">
              {{ post?.comments?.length || 0 }} Comments
            </a>


            <button class="btn btn-light w-100 btn-sm rounded-pill"
                    (click)="openComments(post.id)">
              Comment
            </button>

          </div>
        </div>

        <app-comment-section *ngIf="openPostId === post.id"
                             [postData]="post.comments"
                             (close)="closeComments()">
        </app-comment-section>


      </div>
    </div>
  </div>


