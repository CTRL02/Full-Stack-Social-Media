<div class="profile-container">
  <div class="profile-header">
    <div class="profile-avatar">
      <img [src]="user?.avatar || 'assets/default.jpg'" alt="Profile picture">
      <span class="status-indicator"
            [ngClass]="((presence.onlineUsers$ | async) || []).includes(user?.username || '') ? 'online' : 'offline'">
      </span>
    </div>
    <h1>
      {{ user?.username || 'Username' }}
      <span class="online-text"
            *ngIf="((presence.onlineUsers$ | async) || []).includes(user?.username || '')">ðŸŸ¢ Online</span>
      <span class="offline-text"
            *ngIf="!((presence.onlineUsers$ | async) || []).includes(user?.username || '')">âšª Offline</span>
    </h1>
    <h2>{{ user?.title || 'Member' }}</h2>
  </div>

  <div class="profile-content">
    <div class="profile-section about-section">
      <h3>{{ 'PROFILE.ABOUT' | translate }}</h3>
      <p>{{ user?.bio || 'No bio available' }}</p>
    </div>

    <div class="profile-section stats-section">

      <div class="stat-item">
        <span class="stat-value">{{ user?.noOfPosts || 'no posts' }}</span>
        <span class="stat-label">{{ 'PROFILE.POSTS' | translate }}</span>
      </div>

      <!-- Followers dropdown -->
      <div class="stat-item dropdown">
        <span class="stat-value">{{ user?.noOfFollowers || 0 }}</span>
        <span class="stat-label">{{ 'PROFILE.FOLLOWERS' | translate }}</span>
        <ul class="dropdown-menu">
          <li *ngFor="let follower of user?.followers">
            <img [src]="follower.avatar" alt="avatar" class="dropdown-avatar">
            <span>{{ follower.username }}</span>
          </li>
        </ul>
      </div>

      <!-- Following dropdown -->
      <div class="stat-item dropdown">
        <span class="stat-value">{{ user?.noOfFollowing || 0 }}</span>
        <span class="stat-label">{{ 'PROFILE.FOLLOWING' | translate }}</span>
        <ul class="dropdown-menu">
          <li *ngFor="let followee of user?.following">
            <img [src]="followee.avatar" alt="avatar" class="dropdown-avatar">
            <span>{{ followee.username }}</span>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="profile-footer">
    <div class="social-links">
      <a *ngFor="let link of user?.socialLinks" [href]="link" target="_blank" class="social-link">
        <i [ngClass]="getSocialIcon(link)"></i>
      </a>
    </div>
  </div>
  <!--will do later-->
  <!--<button class="btn btn-primary">Edit Profile</button>-->
  <!-- User Posts Section -->
  <div class="profile-section posts-section" *ngIf="user?.posts?.length">
    <h3>{{ user?.username }} {{ 'PROFILE.POSTS_TITLE' | translate }}</h3>

    <div class="posts-container">
      <!--not to self rather than sending user send only needed fields rather than sending the full allusermodel dto-->
      <ng-container *ngIf="user?.posts as posts">
        <ng-container *ngIf="posts.length > 0; else noPosts">
          <div class="member-profile-container">
            <app-post *ngFor="let post of posts;"
                      [post]="post"
                      [user]="{username: user?.username, avatar: user?.avatar}">
            </app-post>
          </div>
        </ng-container>
      </ng-container>

      <ng-template #noPosts>
        <div class="text-muted text-center">No posts yet.</div>
      </ng-template>




    </div>
  </div>

